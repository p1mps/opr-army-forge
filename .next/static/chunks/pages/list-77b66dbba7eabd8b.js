(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{1804:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Mn}});var r=t(9008),i=t(7294),o=t(5617),s=t(1163),l=t(1852),a=t(7812),c=t(9499),u=t(6242),d=t(7720),f=t(3946),p=t(6540),m=t(5503),h=t(813),x=t(5893);function j(e){return(0,x.jsxs)("div",{className:"px-4 py-2 is-flex is-align-items-center",children:[(0,x.jsxs)("h3",{className:"is-flex-grow-1",style:{fontWeight:600},children:[e.army.name," - ",e.army.versionString]}),e.points&&(0,x.jsxs)("span",{children:[e.points,"pts"]}),(0,x.jsx)(f.Z,{onClick:function(){return e.setCollapsed((function(e){return!e}))},color:"primary",children:e.collapsed?(0,x.jsx)(m.Z,{}):(0,x.jsx)(h.Z,{})})]})}var v=t(5113),y=t(9674),g=t(8449),b=t(6503),Z=t(6486),w=t.n(Z),I=t(970);function O(e){var n=e.unit,t=n.loadout||n.equipment,r=w().groupBy(t,(function(e){return e.name})),i=g.Z.getSize(n);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(v.Z,{className:"p-4",elevation:0,style:{backgroundColor:e.selected?"#F9FDFF":null,borderLeft:e.countInList>0?"2px solid #0F71B4":null,cursor:"pointer"},square:!0,onClick:e.onClick,children:[(0,x.jsxs)("div",{className:"is-flex is-flex-grow-1 is-align-items-center mb-2",children:[(0,x.jsxs)("div",{className:"is-flex-grow-1",children:[(0,x.jsxs)("p",{className:"mb-1",children:[e.countInList>0&&(0,x.jsxs)("span",{style:{color:"#0F71B4"},children:[e.countInList,"x "]}),(0,x.jsxs)("span",{children:[n.customName||n.name," "]}),(0,x.jsxs)("span",{style:{color:"#656565"},children:["[",i,"]"]})]}),(0,x.jsxs)("div",{className:"is-flex",style:{fontSize:"14px",color:"rgba(0,0,0,0.6)"},children:[(0,x.jsxs)("p",{children:["Qua ",n.quality,"+"]}),(0,x.jsxs)("p",{className:"ml-2",children:["Def ",n.defense,"+"]})]})]}),(0,x.jsxs)("p",{children:[I.Z.calculateUnitTotal(n),"pts"]}),e.rightControl]}),(0,x.jsxs)("div",{style:{fontSize:"14px",color:"rgba(0,0,0,0.6)"},children:[(0,x.jsx)("div",{children:Object.values(r).map((function(e,n){var t=e.reduce((function(e,n){return e+n.count}),0);return(0,x.jsxs)("span",{children:[n>0?", ":"",t>1?"".concat(t,"x "):"",y.Z.formatString(e[0])]},n)}))}),(0,x.jsx)(b.Z,{specialRules:n.specialRules.concat(g.Z.getAllUpgradedRules(n))})]})]}),(0,x.jsx)(d.Z,{})]})}var S=t(7622);function C(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return k(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return k(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(l)throw o}}}}function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function A(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(Object(t),!0).forEach((function(n){(0,c.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function T(){var e=(0,o.v9)((function(e){return e.army.loadedArmyBooks}));return(0,x.jsx)(x.Fragment,{children:e.map((function(n){return(0,x.jsx)(U,{army:n,showTitle:e.length>1},n.uid)}))})}function U(e){var n=e.army,t=e.showTitle,r=(0,o.I0)(),l=(0,s.useRouter)(),a=(0,o.v9)((function(e){return e.list})),c=(0,i.useState)(!1),m=c[0],h=c[1],v=function(e){var n,t=function(e,n){return e.specialRules.some((function(e){return"Tough"===e.name&&parseInt(e.rating)>=n}))},r=function(e,n){return e.specialRules.some((function(e){return e.name===n}))},i={Heroes:[],"Core Units":[],"Vehicles / Monsters":[],Artillery:[],Titans:[],Aircraft:[]},o=C(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;r(s,"Hero")?i.Heroes.push(s):r(s,"Aircraft")?i.Aircraft.push(s):r(s,"Artillery")?i.Artillery.push(s):t(s,18)&&"2"==s.defense&&1===s.size&&r(s,"Fear")?i.Titans.push(s):t(s,6)&&"2"==s.defense&&1===s.size?i["Vehicles / Monsters"].push(s):i["Core Units"].push(s)}}catch(l){o.e(l)}finally{o.f()}return i}(n.units);return(0,x.jsxs)(u.Z,{elevation:2,sx:{backgroundColor:"#FAFAFA",marginBottom:"1rem"},square:!0,children:[t&&(0,x.jsx)(j,{army:n,collapsed:m,setCollapsed:h}),!m&&Object.keys(v).map((function(e,t){return(0,x.jsxs)(i.Fragment,{children:["undefined"!==e&&v[e].length>0&&(0,x.jsx)("p",{className:"menu-label my-2 px-4 "+(t>0?"pt-3":""),children:e}),(0,x.jsx)(d.Z,{}),v[e].map((function(e,t){var i,o=null===a||void 0===a?void 0:a.units.filter((function(t){return t.name===e.name&&t.armyId===n.uid&&!t.joinToUnit})).length;return(0,x.jsx)(O,{unit:e,countInList:o,selected:o>0||(null===(i=a.unitPreview)||void 0===i?void 0:i.id)===e.id,onClick:function(){var t;t=e,r((0,S.Xx)(A(A({},t),{},{armyId:n.uid}))),l.push({query:A(A({},l.query),{},{upgradesOpen:!0})})},rightControl:(0,x.jsx)(f.Z,{color:"primary",onClick:function(t){var i;t.stopPropagation(),i=e,r((0,S.Nn)(A(A({},i),{},{armyId:n.uid})))},children:(0,x.jsx)(p.Z,{})})},e.id)}))]},e)}))]})}var P=t(6835),E=t(3343),R=t(1635),z=t(8972),F=t(7594),D=t(9334),B=t(3800),M=t(5294),q=t(7976);function L(e){var n=e.children,t=(0,i.useState)(!1),r=t[0],o=t[1],s=(0,i.useState)(null),l=s[0],a=s[1],c=function(e){o(!1),a(null),e.stopPropagation()};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(f.Z,{onClick:function(e){o(!r),a(e.target),e.stopPropagation()},children:(0,x.jsx)(q.Z,{color:"primary"})}),(0,x.jsx)(M.Z,{open:r,anchorEl:l,onClose:c,onClick:c,children:n})]})}function _(e){var n=e.onSelected,t=e.onUnitRemoved,r=(0,o.v9)((function(e){return e.list})),i=(0,o.v9)((function(e){return e.army.loadedArmyBooks})),s=w().orderBy(r.units.filter((function(e){return!(e.joinToUnit&&r.units.some((function(n){return n.selectionId===e.joinToUnit})))})),(function(e){return e.sortId})),l=w().groupBy(s,(function(e){return e.armyId})),a=Object.keys(l);return(0,x.jsx)(x.Fragment,{children:a.map((function(e){var o=i.find((function(n){return n.uid===e})),s=r.units.filter((function(n){return n.armyId===e})).reduce((function(e,n){return e+I.Z.calculateUnitTotal(n)}),0);return(0,x.jsx)(V,{army:o,showTitle:i.length>1,group:l[e],onSelected:n,onUnitRemoved:t,points:s},e)}))})}function V(e){var n=e.group,t=e.army,r=e.showTitle,s=e.onSelected,l=e.onUnitRemoved,c=e.points,d=(0,o.v9)((function(e){return e.list})),f=(0,i.useState)(!1),p=f[0],m=f[1];return(0,x.jsxs)(u.Z,{elevation:2,sx:{backgroundColor:"#FAFAFA",marginBottom:"1rem"},square:!0,children:[r&&(0,x.jsx)(j,{army:t,collapsed:p,setCollapsed:m,points:c}),!p&&(0,x.jsx)(x.Fragment,{children:n.map((function(e,n){var t=g.Z.getAttachedUnits(d,e),r=w().partition(t,(function(e){return e.specialRules.some((function(e){return"Hero"===e.name}))})),i=(0,P.Z)(r,2),o=i[0],c=i[1],u=t.length>0,f=u&&o.length>0,p=c.reduce((function(e,n){return e+g.Z.getSize(n)}),g.Z.getSize(e)),m=t.reduce((function(e,n){return e+I.Z.calculateUnitTotal(n)}),I.Z.calculateUnitTotal(e)),h=function(e){s(e)};return(0,x.jsxs)("div",{className:u?"my-2":"",style:{backgroundColor:u?"rgba(0,0,0,.12)":""},children:[u&&(0,x.jsxs)("div",{className:"is-flex px-4 py-2 is-align-items-center",children:[(0,x.jsx)(B.Z,{style:{fontSize:"24px",color:"rgba(0,0,0,.38)"}}),(0,x.jsxs)("h3",{className:"ml-2",style:{fontWeight:400,flexGrow:1},children:[f&&"".concat(o[0].customName||o[0].name," & "),e.customName||e.name," [".concat(p,"]")]}),(0,x.jsxs)("p",{className:"mr-2",children:[m,"pts"]}),(0,x.jsx)(L,{children:(0,x.jsx)(W,{units:[e].concat((0,a.Z)(t)).filter((function(e){return e})),text:"Duplicate"})})]}),(0,x.jsxs)("div",{className:u?"ml-1":"",children:[o.map((function(e){return(0,x.jsx)(H,{list:d,unit:e,onSelected:h,onUnitRemoved:l},e.selectionId)})),(0,x.jsx)(H,{list:d,unit:e,onSelected:h,onUnitRemoved:l}),c.map((function(e){return(0,x.jsx)(H,{list:d,unit:e,onSelected:h,onUnitRemoved:l},e.selectionId)}))]})]},n)}))})]})}function H(e){var n=e.list,t=e.unit,r=e.onSelected,i=e.onUnitRemoved,s=(0,o.I0)();return(0,x.jsx)(O,{unit:t,selected:n.selectedUnitId===t.selectionId,onClick:function(){!function(e){n.selectedUnitId!==e.selectionId&&s((0,S.WZ)(e.selectionId)),r(e)}(t)},rightControl:(0,x.jsxs)(L,{children:[(0,x.jsx)(W,{units:[t],text:"Duplicate"}),(0,x.jsxs)(z.Z,{color:"primary",onClick:function(e){!function(e){i(e),s((0,S.ZQ)(e.selectionId))}(t)},children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(E.Z,{})}),(0,x.jsx)(D.Z,{children:"Remove"})]})]})})}function W(e){var n=e.units,t=e.text,r=void 0===t?"":t,i=(0,o.I0)();return(0,x.jsx)(z.Z,{color:"primary",onClick:function(e){!function(e){i((0,S.KR)(e))}(n)},children:r?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(R.Z,{})}),(0,x.jsx)(D.Z,{children:r})]}):(0,x.jsx)(R.Z,{})})}var Q=t(6066),X=(t(1548),t(3873),t(5418),t(3457)),$=t(480),Y=t(9368),G=t(4054),K=t(3841),J=t(315),ee=t(6946),ne=t.n(ee),te=t(3987),re=t(7146),ie=t.n(re),oe=t(465),se=t(705),le=t.n(se);function ae(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return ce(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ce(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(l)throw o}}}}function ce(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ue(e){var n=e.selectedUnit,t=e.upgrade,r=e.option,i=e.isValid,s=(0,o.I0)(),l=function e(r){return r?I.Z.isApplied(n,t,r):!t.options.reduce((function(n,t){return n||e(t)}),!1)},a=l(r);return(0,x.jsx)(oe.Z,{checked:a,onClick:function(){return function(e){if(!e||!l(e)){var r,i=ae(t.options);try{for(i.s();!(r=i.n()).done;){var o=r.value;l(o)&&s((0,S.CB)({unitId:n.selectionId,upgrade:t,option:o}))}}catch(a){i.e(a)}finally{i.f()}e&&s((0,S.Y5)({unitId:n.selectionId,upgrade:t,option:e}))}}(r)},disabled:!i&&!a,name:le()(t),color:"primary",value:(null===r||void 0===r?void 0:r.label)||"None"})}function de(e){var n=e.selectedUnit,t=e.upgrade,r=e.option,i=(0,o.I0)(),s=function(e){return I.Z.isApplied(n,t,e)},l=I.Z.isValid(n,t,r);return(0,x.jsx)(Y.Z,{checked:s(r),onClick:function(){return function(e){var r=s(e);i(r?(0,S.CB)({unitId:n.selectionId,upgrade:t,option:e}):(0,S.Y5)({unitId:n.selectionId,upgrade:t,option:e}))}(r)},value:r.label,disabled:!l})}function fe(e){var n=e.selectedUnit,t=e.upgrade,r=e.option,i=(0,o.I0)();try{var s=I.Z.countApplied(n,t,r),l=I.Z.isValid(n,t,r);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(f.Z,{disabled:0===s,color:s>0?"primary":"default",onClick:function(){return function(e,n,t){i((0,S.CB)({unitId:e.selectionId,upgrade:n,option:t}))}(n,t,r)},children:(0,x.jsx)(m.Z,{})}),(0,x.jsx)("div",{style:{color:l?"#000000":"rgba(0,0,0,.5)"},children:s}),(0,x.jsx)(f.Z,{disabled:!l,color:"primary",onClick:function(){return function(e,n,t){i((0,S.Y5)({unitId:e.selectionId,upgrade:n,option:t}))}(n,t,r)},children:(0,x.jsx)(h.Z,{})})]})}catch(a){console.log(n),console.log(t),console.log(r)}}var pe=t(9358),me=t(3450),he=t.n(me);function xe(e){var n=e.selectedUnit,t=e.upgrade,r=e.option,i=e.previewMode,o=e.label,s=e.controlType,l=r?(0,pe.vM)(r.gains,"name"):null,a=!r||I.Z.isValid(n,t,r),c=function(){switch(s){case"check":return(0,x.jsx)(de,{selectedUnit:n,upgrade:t,option:r});case"radio":return(0,x.jsx)(ue,{selectedUnit:n,upgrade:t,option:r,isValid:a});case"updown":return(0,x.jsx)(fe,{selectedUnit:n,upgrade:t,option:r})}}();return(0,x.jsxs)("div",{className:"is-flex is-align-items-center mb-1",children:[(0,x.jsx)("div",{className:"is-flex-grow-1 pr-2",children:l?Object.keys(l).map((function(e,n){var t=l[e],r=t[0],i=t.reduce((function(e,n){return e+(n.count||1)}),0);return(0,x.jsx)(je,{eqp:r,count:i,isValid:a},e)})):(0,x.jsx)("span",{style:{color:"rgba(0,0,0,0.8)"},children:o})}),(0,x.jsxs)("div",{style:{color:a?null:"rgba(0,0,0,.5)"},children:[null!==r&&void 0!==r&&r.cost?"".concat(r.cost,"pts"):"Free","\xa0"]}),!i&&c]})}function je(e){var n=e.eqp,t=e.count,r=e.isValid,i=t>1?he().plural(n.name||n.label):n.name||n.label,o="rgba(0,0,0,.5)",s=r?"#000000":o,l=r?"#656565":o;switch(n.type){case"ArmyBookDefense":case"ArmyBookRule":return(0,x.jsx)(ve,{rule:n,colour:s});case"ArmyBookWeapon":return(0,x.jsx)(ye,{weapon:n,name:i,count:t,colour:s,subtextColour:l});case"ArmyBookItem":return(0,x.jsx)(ge,{item:n,name:i,count:t,colour:s,subtextColour:l,isValid:r});default:console.log("Cannot display upgrade: ",n)}}function ve(e){return(0,x.jsx)("span",{style:{color:e.colour},children:(0,x.jsx)(b.Z,{specialRules:[e.rule]})})}function ye(e){var n=e.weapon,t=n&&n.range?"".concat(n.range,'"'):null,r=n&&n.attacks?"A".concat(n.attacks):null,i=n.specialRules;return(0,x.jsxs)(x.Fragment,{children:[e.count>1&&(0,x.jsxs)("span",{children:[e.count,"x "]}),(0,x.jsxs)("span",{className:ie().upgradeName,style:{color:e.colour},children:[e.name," "]}),(0,x.jsxs)("span",{className:ie().upgradeRules,style:{color:e.subtextColour},children:["(",[t,r].filter((function(e){return e})).join(", ")+((null===i||void 0===i?void 0:i.length)>0?", ":""),(0,x.jsx)(b.Z,{specialRules:i}),")"]})]})}function ge(e){var n=e.item,t=e.count,r=e.name,o=e.colour,s=e.subtextColour,l=e.isValid;return(0,x.jsxs)(x.Fragment,{children:[t>1&&(0,x.jsxs)("span",{children:[t,"x "]}),(0,x.jsxs)("span",{className:ie().upgradeName,style:{color:o},children:[r," "]}),(0,x.jsxs)("span",{className:ie().upgradeRules,style:{color:s},children:["(",n.content.map((function(e,n){return(0,x.jsxs)(i.Fragment,{children:[(0,x.jsx)("span",{children:0===n?"":", "}),(0,x.jsx)(je,{eqp:e,count:t,isValid:l})]},n)})),")"]})]})}function be(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return Ze(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ze(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(l)throw o}}}}function Ze(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function we(e){var n,t,r=e.unit,i=e.upgrade,o=e.previewMode,s=I.Z.getControlType(r,i),l=function(e){var n=r.equipment.find((function(n){return y.Z.compareEquipment(n,e)}));return n?y.Z.formatString(n):""},a="replace"===i.type?"Default":"None",c="radio"===s&&(0,x.jsx)(xe,{selectedUnit:r,upgrade:i,option:null,previewMode:o,controlType:s,label:a}),u=i.label,d=be(null!==(n=i.replaceWhat)&&void 0!==n?n:[]);try{for(d.s();!(t=d.n()).done;){var f=t.value,p=l(f);p&&(u=u.replace(f,p))}}catch(m){d.e(m)}finally{d.f()}return(0,x.jsxs)("div",{className:"mt-4",children:[(0,x.jsxs)("div",{className:"px-4 is-flex is-align-items-center",children:[r.combined&&"all"===i.affects&&(0,x.jsx)(te.W,{title:"This option will be the same on both combined units.",arrow:!0,enterTouchDelay:0,leaveTouchDelay:5e3,children:(0,x.jsx)(B.Z,{sx:{fontSize:22},className:"mr-2"})}),(0,x.jsxs)("p",{className:"pt-0",style:{fontWeight:"600",lineHeight:1.7},children:[u," ","replace"===i.type&&"radio"!==s&&(0,x.jsxs)("span",{style:{color:"rgba(0,0,0,0.6)"},children:["[",I.Z.countAvailable(r,i),"]"]})]})]}),(0,x.jsxs)(v.Z,{className:"px-4 py-2",square:!0,elevation:0,children:[c,i.options.map((function(e,n){return(0,x.jsx)(xe,{selectedUnit:r,upgrade:i,option:e,controlType:s,previewMode:o},n)}))]})]})}var Ie=t(8052),Oe=t(2548),Se=t(2882),Ce=t(7906),ke=t(3184),Ne=t(3816),Ae=t(3252),Te=t(295);function Ue(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Pe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ue(Object(t),!0).forEach((function(n){(0,c.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ue(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Ee(e,n){var t=e.unit,r=(n.unit,(0,o.v9)((function(e){return e.army.loadedArmyBooks})).find((function(e){return e.uid===t.armyId}))),i=null===r||void 0===r?void 0:r.spells,s={paddingLeft:"8px",paddingRight:"8px",borderBottom:"none"},l=Pe(Pe({},s),{},{fontWeight:600,whiteSpace:"nowrap"});return(0,x.jsx)(Se.Z,{component:v.Z,elevation:0,style:{border:"1px solid rgba(0,0,0,.12)"},children:(0,x.jsxs)(Ce.Z,{size:"small",children:[(0,x.jsx)(ke.Z,{children:(0,x.jsxs)(Ne.Z,{style:{backgroundColor:"#EBEBEB",fontWeight:600},children:[(0,x.jsx)(Ae.Z,{style:l,children:"Spell"}),(0,x.jsx)(Ae.Z,{style:l,children:"Description"})]})}),(0,x.jsx)(Te.Z,{children:i&&i.map((function(e){return(0,x.jsxs)(Ne.Z,{children:[(0,x.jsxs)(Ae.Z,{style:l,children:[e.name," (",e.threshold,"+)"]}),(0,x.jsx)(Ae.Z,{style:s,children:e.effect})]},e.name)}))})]})})}var Re=t(2280),ze=t(8895),Fe=t(2797),De=t(4631),Be=t(3508);function Me(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return qe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return qe(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(l)throw o}}}}function qe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Le(e){var n,t=e.unit,r=(0,o.I0)(),i=t.specialRules.some((function(e){return"Hero"===e.name})),s=(0,De.y)(),l=s[i?"heroes":"units"],a=s.injuries,c=s.talents,d=t.xp?Math.floor(t.xp/5):0,p=function(e){return!!a.find((function(n){return n.name===e}))},j=function(e){return!!a.find((function(n){return n.name===e}))},v=0,y=0,g=0,Z=Me(t.traits);try{for(Z.s();!(n=Z.n()).done;){var w=n.value;p(w)?y++:j(w)?g++:v++}}catch(N){Z.e(N)}finally{Z.f()}var I=function(e){r((0,S.Ke)({unitId:t.selectionId,xp:e}))},O=function(e){r((0,S.v$)({unitId:t.selectionId,trait:e.name}))},C=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.map((function(e){var r,i=!(null===(r=t.traits)||void 0===r||!r.find((function(n){return n===e.name})));return(0,x.jsxs)("div",{className:"is-flex is-align-items-center",children:[(0,x.jsx)("div",{className:"is-flex-grow-1 pr-2",children:(0,x.jsx)(b.Z,{specialRules:[e]})}),(0,x.jsx)(Y.Z,{checked:i,onClick:function(){return O(e)},value:e.name,disabled:!!n&&t.xp<5})]},e.name)}))},k=function(e){return e>0&&(0,x.jsxs)("span",{className:"ml-1",style:{color:"#9E9E9E"},children:[" ","[",e,"]"]})};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"px-4 mt-4 is-flex is-align-items-center",children:(0,x.jsx)("p",{className:"pt-0",style:{fontWeight:600,lineHeight:1.7},children:"Campaign Traits"})}),(0,x.jsx)(u.Z,{elevation:0,square:!0,children:(0,x.jsxs)("div",{className:"pt-2 pb-4 px-4",children:[(0,x.jsxs)("div",{className:"is-flex is-align-items-center",children:[(0,x.jsxs)("div",{className:"is-flex-grow-1 pr-2",children:["Unit XP ",(0,x.jsxs)("span",{style:{color:"rgba(0,0,0,0.6)"},children:["(Level ",d,")"]})]}),(0,x.jsx)(f.Z,{disabled:0===t.xp,color:t.xp>0?"primary":"default",onClick:function(){return I(-1)},children:(0,x.jsx)(m.Z,{})}),(0,x.jsxs)("div",{style:{color:"#000000"},children:[t.xp,"XP"]}),(0,x.jsx)(f.Z,{disabled:t.xp>=30,color:"primary",onClick:function(){return I(1)},children:(0,x.jsx)(h.Z,{})})]}),(0,x.jsx)("div",{children:(0,x.jsxs)(Re.Z,{children:[(0,x.jsxs)(ze.Z,{expandIcon:(0,x.jsx)(Be.Z,{}),children:[i?"Skill Sets ":"Traits ",k(v)]}),(0,x.jsx)(Fe.Z,{children:i?l.map((function(e){return(0,x.jsxs)(Re.Z,{children:[(0,x.jsx)(ze.Z,{expandIcon:(0,x.jsx)(Be.Z,{}),children:e.name}),(0,x.jsx)(Fe.Z,{children:C(e.traits,!0)})]},e.name)})):C(l,!0)})]})}),(0,x.jsxs)("div",{className:"mt-4",children:[i&&(0,x.jsxs)(Re.Z,{children:[(0,x.jsxs)(ze.Z,{expandIcon:(0,x.jsx)(Be.Z,{}),children:["Injuries ",k(y)]}),(0,x.jsx)(Fe.Z,{children:C(a)})]}),i&&(0,x.jsxs)(Re.Z,{children:[(0,x.jsxs)(ze.Z,{expandIcon:(0,x.jsx)(Be.Z,{}),children:["Talents ",k(g)]}),(0,x.jsx)(Fe.Z,{children:C(c)})]})]})]})})]})}var _e=t(1903),Ve=t(7856);function He(e){var n=e.selectedUnit,t=(0,o.I0)(),r=(0,i.useState)(null),s=r[0],l=r[1];(0,i.useEffect)((function(){l(null===n||void 0===n?void 0:n.notes)}),[n]);var a=(0,i.useCallback)((0,Ve.D)(750,(function(e){return t((0,S.RQ)({unitId:n.selectionId,notes:e}))})),[n]);return(0,x.jsx)(_e.Z,{multiline:!0,label:"Notes",fullWidth:!0,value:s,onChange:function(e){console.log(e.target.value);var n=e.target.value;l(n),a(n)}})}function We(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return Qe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qe(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(l)throw o}}}}function Qe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Xe(e){var n,t=e.mobile,r=void 0!==t&&t,i=(0,o.v9)((function(e){return e.list})),s=(0,o.v9)((function(e){return e.army})),l=s.gameSystem,c=s.loadedArmyBooks,u=s.rules,d=(0,o.I0)(),f=!!i.unitPreview,p=null!==(n=i.unitPreview)&&void 0!==n?n:g.Z.getSelected(i),m=p&&(null===c||void 0===c?void 0:c.find((function(e){return e.uid===p.armyId}))),h=c.flatMap((function(e){return e.specialRules})),j=u.concat(h),y=p&&p.equipment.filter((function(e){var n;return!e.attacks&&(null===(n=e.specialRules)||void 0===n?void 0:n.length)})).reduce((function(e,n){return e.concat(n.specialRules)}),[]),Z=p&&g.Z.getAllUpgradedRules(p),w=p&&(p.specialRules||[]).concat(y).concat(Z).filter((function(e){return"-"!==e.name})),I="gf"!==l&&"aof"!==l,O=!!p&&p.specialRules.findIndex((function(e){return"Hero"===e.name}))>-1,C=function(){var e,n=!1,t=We(null!==w&&void 0!==w?w:[]);try{var r=function(){var t=e.value;n||(n="Psychic"===t.name||"Wizard"===t.name);var r=j.find((function(e){return e.name===t.name}));console.log(t.name,r);var i=null===r||void 0===r?void 0:r.description;n||(n=i&&/(?:Psychic|Wizard)\(\d\)/i.test(i))};for(t.s();!(e=t.n()).done;)r()}catch(i){t.e(i)}finally{t.f()}return n}(),k=function(e){var n=e.target.value;-1!==T.indexOf(p.selectionId)&&i.units.filter((function(e){return e.specialRules.some((function(e){return"Hero"===e.name}))&&e.joinToUnit==p.selectionId})).forEach((function(e){d((0,S.lN)({unitId:e.selectionId,joinToUnitId:n}))}));d((0,S.lN)({unitId:p.selectionId,joinToUnitId:n})),n&&d((0,S.Qh)({from:i.units.findIndex((function(e){return e.selectionId==p.selectionId})),to:i.units.findIndex((function(e){return e.selectionId==n}))}))},N=((null===p||void 0===p?void 0:p.upgrades)||[]).map((function(e){return n=e,m.upgradePackages.filter((function(e){return e.uid===n}))[0];var n})).filter((function(e){return!!e})),A=O?N:[].concat((0,a.Z)(N.splice(1)),[N[0]]).filter((function(e){return!!e})),T=i.units.filter((function(e){return e.specialRules.some((function(e){return"Hero"===e.name}))})).filter((function(e){return e.joinToUnit})).map((function(e){return e.joinToUnit})),U=i.units.filter((function(e){return!e.joinToUnit})).filter((function(e){return!0}));return(0,x.jsxs)("div",{className:r?ne()["upgrade-panel-mobile"]:ne()["upgrade-panel"],children:[p&&(0,x.jsxs)(v.Z,{square:!0,elevation:0,className:"pb-4",children:[!f&&!O&&!I&&(0,x.jsxs)(X.Z,{className:"px-4 pt-2 is-flex-direction-row is-align-items-center",children:[(0,x.jsx)($.Z,{control:(0,x.jsx)(Y.Z,{checked:p.combined,onClick:function(){return function(){if(p.combined)if(p.joinToUnit){var e=p.selectionId;d((0,S.WZ)(p.joinToUnit)),d((0,S.ZQ)(e))}else{var n=i.units.find((function(e){return e.combined&&e.joinToUnit===p.selectionId})).selectionId;d((0,S.ZQ)(n))}else d((0,S.iQ)(p.selectionId))}()}}),label:"Combined Unit",className:"mr-2"}),(0,x.jsx)(te.W,{title:"When preparing your army you may merge units by deploying two copies of the same unit as a single big unit, as long as any upgrades that are applied to all models are bought for both.",arrow:!0,enterTouchDelay:0,leaveTouchDelay:5e3,children:(0,x.jsx)(Oe.Z,{color:"primary"})})]}),!f&&!I&&O&&(0,x.jsx)(X.Z,{className:"px-4 pt-2 pb-3",children:(0,x.jsxs)(G.Z,{fullWidth:!0,children:[(0,x.jsx)(K.Z,{id:"demo-simple-select-label",sx:{zIndex:"unset"},children:"Join To Unit"}),(0,x.jsxs)(J.Z,{value:(null===p||void 0===p?void 0:p.joinToUnit)||"",label:"Join To Unit",onChange:k,children:[(0,x.jsx)(z.Z,{value:null,children:"None"}),U.filter((function(e){return e!=p})).map((function(e,n){return(0,x.jsxs)(z.Z,{value:e.selectionId,children:[e.customName||e.name," [",e.size*(e.combined?2:1),"]"]},n)}))]})]})}),(0,x.jsxs)("div",{className:"px-4 pt-4 pb-2",children:["Qua ",p.quality,"+ Def ",p.defense,"+"]}),(null===w||void 0===w?void 0:w.length)>0&&(0,x.jsx)("div",{className:"px-4 pb-4",children:(0,x.jsx)(b.Z,{specialRules:w})}),(0,x.jsx)("div",{className:"px-4 pb-4",children:(0,x.jsx)(Ie.Z,{unit:p,square:!0})}),C&&(0,x.jsx)("div",{className:"px-4 pt-2",children:(0,x.jsx)(Ee,{unit:p})}),(0,x.jsx)("div",{className:"mx-4",children:(0,x.jsx)(He,{selectedUnit:p})})]}),i.campaignMode&&p&&!f&&(0,x.jsx)(Le,{unit:p}),A.map((function(e){return(0,x.jsx)("div",{children:e.sections.filter((function(e){return-1===p.disabledUpgradeSections.indexOf(e.uid)})).map((function(e,n){return(0,x.jsx)(we,{unit:p,upgrade:e,previewMode:f},e.uid)}))},e.uid)}))]})}var $e=t(1953),Ye=t(2293),Ge=t(1703),Ke=t(44),Je=t(3321),en=t(6246);function nn(){var e,n=(0,o.v9)((function(e){return e.list})),t=(0,o.I0)(),r=(0,i.useState)(!1),s=r[0],l=r[1],a=(0,i.useState)(""),c=a[0],u=a[1],d=null!==(e=n.unitPreview)&&void 0!==e?e:g.Z.getSelected(n),p=!!n.unitPreview;(0,i.useEffect)((function(){var e,n;u(null!==(e=null!==(n=null===d||void 0===d?void 0:d.customName)&&void 0!==n?n:null===d||void 0===d?void 0:d.name)&&void 0!==e?e:"")}),[null===d||void 0===d?void 0:d.selectionId]);var m=(0,i.useCallback)((0,Ve.D)(1e3,(function(e){return t((0,S.Ah)({unitId:d.selectionId,name:e}))})),[n]);if(!d)return null;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"is-flex is-align-items-center",children:[s?(0,x.jsx)(_e.Z,{autoFocus:!0,variant:"standard",className:"",value:c,onChange:function(e){u(e.target.value),m(e.target.value)}}):(0,x.jsx)("div",{className:"is-flex",style:{maxWidth:"calc(100% - 7rem)"},children:(0,x.jsxs)("h3",{className:"is-size-4 has-text-left unitName",children:[d.customName||d.name," ","[".concat(g.Z.getSize(d),"]")]})}),!p&&(0,x.jsx)(f.Z,{color:"primary",className:"ml-2",onClick:function(){l(!s)},children:(0,x.jsx)(en.Z,{})}),(0,x.jsxs)("p",{className:"ml-4 is-flex-grow-1",style:{textAlign:"right"},children:[I.Z.calculateUnitTotal(d),"pts"]})]}),p&&(0,x.jsx)(Je.Z,{variant:"contained",className:"mt-2",style:{width:"100%"},onClick:function(){return t((0,S.Nn)(n.unitPreview))},children:"Add to My List"})]})}var tn=t(155),rn=t(8862),on=t(1849),sn=t(3926),ln=t(8462),an=t(7212),cn=t(4866),un=t(2961),dn=t(6638),fn=t(3304),pn=t(3744),mn=t(657),hn=t(8557),xn=t(2777),jn=t(2262),vn={gf:200,gff:30,aof:165,aofs:25},yn={gf:500,gff:150,aof:500,aofs:150},gn={gf:1e3,gff:150,aof:1e3,aofs:150},bn=function(){function e(){(0,xn.Z)(this,e)}return(0,jn.Z)(e,null,[{key:"getErrors",value:function(e,n){if(!e||!n)return[];var t=[];n.pointsLimit>0&&n.points>n.pointsLimit&&t.push("Points limit exceeded: ".concat(n.points,"/").concat(n.pointsLimit));var r=e.gameSystem,i=n.pointsLimit||n.points,o=n.units,s=o.filter((function(e){return!e.joinToUnit})).length,l=o.filter((function(e){return e.specialRules.some((function(e){return"Hero"===e.name}))})),a=l.length,c=l.filter((function(e){return e.joinToUnit&&o.some((function(n){return n.selectionId===e.joinToUnit}))})).map((function(e){return e.joinToUnit})),u=1+Math.floor(i/gn[r]),d=w().groupBy(o.filter((function(e){return!(e.combined&&!e.joinToUnit)})),(function(e){return e.id})),f=Object.keys(d).map((function(e){return{unitName:o.find((function(n){return n.id===e})).name,count:d[e].length}})).filter((function(e){return e.count>u}));if(a>Math.floor(i/yn[r])&&t.push("Max 1 hero per full ".concat(yn[r],"pts.")),s>Math.floor(i/vn[r])){var p="gf"===r||"aof"===r?" (combined units count as just 1 unit)":"";t.push("Max 1 unit per full ".concat(vn[r],"pts").concat(p,"."))}f.length>0&&t.push("Cannot have more than ".concat(u," copies of a particular unit (").concat(f.map((function(e){return e.unitName})).join(", "),").")),"gf"!==e.gameSystem&&"aof"!==e.gameSystem||(o.some((function(e){return e.combined&&1===e.size}))&&t.push("Cannot combine units of unit size [1]."),o.some((function(e){return 1===e.size&&c.includes(e.selectionId)}))&&t.push("Heroes cannot join units that only contain a single model."),new Set(c).size<c.length&&t.push("A unit can only have a maximum of one Hero attached.")),e.loadedArmyBooks.length>2&&t.push("Players may bring units from up to two factions in the same list.");var m=w().groupBy(o,(function(e){return e.armyId})),h=Object.keys(m).map((function(e){return m[e].reduce((function(e,n){return e+I.Z.calculateUnitTotal(n)}),0)}));return n.points>0&&e.loadedArmyBooks.length>1&&!h.some((function(e){return e/i*100>=60}))&&t.push("Mixed armies must consist of at least 60% worth of units from their primary faction."),t}}]),e}();function Zn(e){var n=e.open,t=e.setOpen,r=(0,o.v9)((function(e){return e.army})),i=(0,o.v9)((function(e){return e.list})),s=bn.getErrors(r,i);return(0,x.jsxs)(mn.Z,{onClose:function(){return t(!1)},open:n,children:[(0,x.jsx)(hn.Z,{children:"Competitive List Validation"}),(0,x.jsx)(ln.Z,{children:s.map((function(e,n){return(0,x.jsx)(an.ZP,{divider:!0,children:(0,x.jsx)(D.Z,{children:e})},n)}))})]})}var wn=t(8989),In=t(3173),On=t(9609),Sn=t(690),Cn=t(8188),kn=t(3180),Nn=t(5071);function An(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Tn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?An(Object(t),!0).forEach((function(n){(0,c.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):An(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Un(){var e=(0,o.v9)((function(e){return e.army})),n=(0,o.v9)((function(e){return e.list})),t=(0,o.I0)(),r=(0,s.useRouter)(),a=(0,i.useState)(null),c=a[0],u=a[1],p=(0,i.useState)(null),m=p[0],h=p[1],j=(0,i.useState)(!1),y=j[0],g=j[1],b=bn.getErrors(e,n),Z=function(){var r=pn.Z.createSave(e,n.name,n);return t((0,S.hg)(r)),r},w=(0,l.useMediaQuery)({query:"(min-width: 1024px)"});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Ye.Z,{elevation:0,style:{position:"sticky",top:0,zIndex:1},children:(0,x.jsxs)(tn.Z,{className:"p-0",children:[(0,x.jsx)(f.Z,{size:"large",edge:"start",color:"inherit","aria-label":"menu",onClick:function(){(n.creationTime||confirm("Going back will leave your current list and go back home. Continue?"))&&r.replace("/")},style:{marginLeft:"0"},className:"mr-4",children:(0,x.jsx)(dn.Z,{})}),(0,x.jsx)(rn.Z,{variant:"h6",component:"div",sx:{flexGrow:1},children:n.name}),b.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(f.Z,{size:"large",color:"inherit",title:"Validation warnings",style:{backgroundColor:Boolean(m)?"#6EAAE7":null},onClick:function(e){return h(e.currentTarget)},className:"mr-2 p-2",children:(0,x.jsx)(fn.Z,{})}),(0,x.jsx)(on.Z,{placement:"bottom-end",anchorEl:m,open:Boolean(m)&&w,children:(0,x.jsx)(sn.Z,{onClickAway:function(e){return h(null)},children:(0,x.jsx)(v.Z,{children:(0,x.jsxs)(ln.Z,{children:[(0,x.jsx)(an.ZP,{divider:!0,children:(0,x.jsx)(D.Z,{children:(0,x.jsx)("span",{style:{fontWeight:600},children:"Competitive List Validation"})})}),b.map((function(e,n){return(0,x.jsx)(an.ZP,{className:"mx-4 Ppx-0",style:{width:"auto"},divider:n<b.length-1,children:(0,x.jsx)(D.Z,{children:e})},n)}))]})})})})]}),w&&(0,x.jsx)(f.Z,{size:"large",color:"inherit","aria-label":"menu",title:"View list",onClick:function(){return r.push("/view")},className:"mr-2",children:(0,x.jsx)(un.Z,{})}),(0,x.jsx)(f.Z,{size:"large",edge:"start",color:"inherit","aria-label":"menu",onClick:function(e){return u(e.currentTarget)},children:(0,x.jsx)(q.Z,{})}),(0,x.jsxs)(M.Z,{id:"menu-appbar",anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(c),onClose:function(e){return u(null)},children:[(0,x.jsxs)(z.Z,{onClick:function(){r.push({pathname:"/listConfiguration",query:Tn(Tn({},r.query),{},{edit:!0})})},children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(On.Z,{sx:{color:"#9E9E9E"}})}),(0,x.jsx)(D.Z,{children:"Edit Details"})]}),(0,x.jsxs)(z.Z,{onClick:function(){return r.push("/view")},children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(kn.Z,{sx:{color:"#9E9E9E"}})}),(0,x.jsx)(D.Z,{children:"View Cards"})]}),!n.creationTime&&(0,x.jsx)(z.Z,{onClick:Z,children:"Save"}),n.creationTime&&(0,x.jsxs)(z.Z,{onClick:function(){confirm("Are you sure you want to delete this list?")&&(pn.Z.delete(n),r.replace("/"))},children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(In.Z,{sx:{color:"#9E9E9E"}})}),(0,x.jsx)(D.Z,{children:"Delete List"})]}),(0,x.jsxs)(z.Z,{onClick:function(){r.push("/load")},children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(Cn.Z,{sx:{color:"#9E9E9E"}})}),(0,x.jsx)(D.Z,{children:"Open a List"})]}),(0,x.jsx)(d.Z,{}),(0,x.jsxs)(z.Z,{onClick:function(){if(n.creationTime)pn.Z.download(n);else{var e=Z();pn.Z.download(Tn(Tn({},n),{},{creationTime:e}))}},children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(Nn.Z,{})}),(0,x.jsx)(D.Z,{children:"Export as Army Forge File"})]}),(0,x.jsx)(z.Z,{onClick:function(){if(n.creationTime)pn.Z.downloadTTS(n);else{var e=Z();pn.Z.downloadTTS(Tn(Tn({},n),{},{creationTime:e}))}},children:"Export as TTS File"}),(0,x.jsxs)(z.Z,{onClick:function(){pn.Z.copyAsText(n),g(!0)},children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(Sn.Z,{sx:{color:"#9E9E9E"}})}),(0,x.jsx)(D.Z,{children:"Export as Text"})]}),(0,x.jsx)(d.Z,{}),(0,x.jsx)(z.Z,{onClick:function(){window.open("https://webapp.onepagerules.com","_blank")},children:"Open OPR Webapp"}),(0,x.jsx)(z.Z,{onClick:function(){return t((0,wn.jp)(!0))},children:"See Release Notes"})]})]})}),(0,x.jsx)(Zn,{open:Boolean(m)&&!w,setOpen:h}),(0,x.jsx)(cn.Z,{open:y,onClose:function(){return g(!1)},message:"Army list copied to your clipboard.",anchorOrigin:{vertical:"bottom",horizontal:"center"},autoHideDuration:4e3})]})}var Pn=t(594);function En(e){var n,t=e.open,r=e.setOpen,i=(0,o.v9)((function(e){return e.list.undoUnitRemove})),s=i&&Array.isArray(i)?i[0]:null,l=(0,o.I0)(),a=(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Je.Z,{color:"primary",size:"small",onClick:function(){l((0,S.i)()),r(!1)},children:"UNDO"}),(0,x.jsx)(f.Z,{size:"small","aria-label":"close",color:"inherit",onClick:function(){return r(!1)},children:(0,x.jsx)(Pn.Z,{fontSize:"small"})})]});return(0,x.jsx)(cn.Z,{message:"".concat(null!==(n=null===s||void 0===s?void 0:s.customName)&&void 0!==n?n:null===s||void 0===s?void 0:s.name," has been removed"),autoHideDuration:4e3,action:a,anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t,onClose:function(){return r(!1)}})}function Rn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function zn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Rn(Object(t),!0).forEach((function(n){(0,c.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Rn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Fn(){var e,n=(0,o.v9)((function(e){return e.list})),t=(0,o.v9)((function(e){return e.army})),r=(0,o.I0)(),l=(0,s.useRouter)(),c="true"==l.query.upgradesOpen,u=null===t||void 0===t||null===(e=t.loadedArmyBooks)||void 0===e?void 0:e[0],d=(0,i.useState)(null),f=d[0],m=d[1],h=(0,i.useState)(1),j=h[0],y=h[1],g=(0,i.useState)(!1),b=g[0],Z=g[1],w=(0,i.useState)(!1),I=w[0],O=w[1];var C=function(e,n){y(n),f.slickGoTo(n)},k={dots:!1,slidesToShow:1,infinite:!1,arrows:!1,initialSlide:1,beforeChange:function(e,n){return C(0,n)}};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(v.Z,{elevation:1,color:"primary",square:!0,style:{position:"sticky",top:0,zIndex:1},children:[(0,x.jsx)(Un,{}),(0,x.jsx)(Ye.Z,{elevation:0,style:{position:"sticky",top:0,zIndex:1},children:(0,x.jsxs)(Ge.Z,{value:j,onChange:C,centered:!0,variant:"fullWidth",textColor:"inherit",indicatorColor:"primary",children:[(0,x.jsx)(Ke.Z,{sx:{fontWeight:600},label:(null===t||void 0===t?void 0:t.loadedArmyBooks.length)>1?"Army Books":"".concat(null===u||void 0===u?void 0:u.name," ").concat(null===u||void 0===u?void 0:u.versionString)}),(0,x.jsx)(Ke.Z,{sx:{fontWeight:600},label:"My List - ".concat(n.points,"pts")})]})})]}),(0,x.jsxs)(Q.Z,zn(zn({},k),{},{ref:function(e){return m(e)},style:{maxHeight:"100%"},children:[(0,x.jsx)(T,{}),n.units.length>0?(0,x.jsx)(_,{onSelected:function(e){l.push({query:zn(zn({},l.query),{},{upgradesOpen:!0})})},onUnitRemoved:function(){return O(!0)}}):(0,x.jsxs)("div",{className:"p-4 has-text-centered",children:[(0,x.jsx)("h3",{className:"is-size-3 mb-4",children:"Your list is empty"}),(0,x.jsxs)(Je.Z,{variant:"outlined",onClick:function(){return C(0,0)},children:[(0,x.jsx)(p.Z,{})," Add Units"]}),(0,x.jsx)("div",{className:"is-flex mt-6",style:{height:"160px",width:"100%",backgroundImage:'url("img/gf_armies/'.concat(null===u||void 0===u?void 0:u.name,'.png")'),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",position:"relative",zIndex:1,opacity:.5}})]})]})),(0,x.jsx)($e.R,{open:c,onDismiss:function(){delete l.query.upgradesOpen,l.push({query:zn({},l.query)}),r((0,S.WZ)(null))},initialFocusRef:!1,expandOnContentDrag:!0,onScrollCapture:function(e){return e.preventDefault()},defaultSnap:function(e){var n=e.snapPoints,t=e.lastSnap;return null!==t&&void 0!==t?t:Math.min.apply(Math,(0,a.Z)(n))},snapPoints:function(e){return[e.minHeight,.9*e.maxHeight]},header:(0,x.jsx)(nn,{}),children:(0,x.jsx)(Xe,{mobile:!0})}),(0,x.jsx)(Zn,{open:b,setOpen:Z}),(0,x.jsx)(En,{open:I,setOpen:O})]})}function Dn(){var e=(0,o.v9)((function(e){return e.list})),n=(0,o.v9)((function(e){return e.army.loadedArmyBooks})),t=(0,i.useState)(!1),r=t[0],s=t[1],l=(0,i.useState)(!1),a=l[0],c=l[1],d=null===n||void 0===n?void 0:n[0],f={overflowY:"scroll",maxHeight:"100%"},p=function(e){var n=e.target;n.scrollTop?n.classList.add("scrolled"):n.classList.remove("scrolled")};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(v.Z,{elevation:1,color:"primary",square:!0,children:(0,x.jsx)(Un,{})}),(0,x.jsxs)("div",{className:"columns my-0",style:{height:"calc(100vh - 64px)"},children:[(0,x.jsxs)("div",{className:"column py-0 pr-0",style:f,onScroll:p,children:[(0,x.jsx)(u.Z,{square:!0,elevation:3,children:(0,x.jsx)("h3",{className:"p-4 is-size-4 is-hidden-mobile",children:n.length>1?"Army Books":"".concat(d.name," - ").concat(d.versionString)})}),(0,x.jsx)(T,{})]}),(0,x.jsxs)("div",{className:"column p-0",style:f,onScroll:p,children:[(0,x.jsx)(u.Z,{square:!0,elevation:3,children:(0,x.jsx)("h3",{className:"p-4 is-size-4 is-hidden-mobile",children:"My List - ".concat(e.points)+(e.pointsLimit?"/".concat(e.pointsLimit):"")+"pts"})}),(0,x.jsx)(_,{onSelected:function(){},onUnitRemoved:function(){return c(!0)}})]}),(0,x.jsxs)("div",{className:"column py-0 px-0 mr-4",style:f,onScroll:p,children:[(0,x.jsx)(u.Z,{square:!0,elevation:1,className:"px-4 pt-4 pb-2 sticky",children:(0,x.jsx)(nn,{})}),(0,x.jsx)(Xe,{})]})]}),(0,x.jsx)(Zn,{open:r,setOpen:s}),(0,x.jsx)(En,{open:a,setOpen:c})]})}var Bn=t(8595);function Mn(){var e=(0,o.v9)((function(e){return e.army})),n=(0,s.useRouter)(),t=(0,o.I0)();(0,i.useEffect)((function(){if(!e.loaded){var r=n.query.listId;return r?void pn.Z.loadFromKey(t,r,(function(e){})):void n.push({pathname:"/gameSystem",query:n.query},null,{shallow:!0})}t((0,Bn.Ty)(e.gameSystem))}),[]);var a=(0,l.useMediaQuery)({query:"(min-width: 1024px)"});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(r.default,{children:[(0,x.jsx)("title",{children:"OPR Army Forge"}),(0,x.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),e.loaded?a?(0,x.jsx)(Dn,{}):(0,x.jsx)(Fn,{}):null]})}},5071:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(5893);function i(e){var n=e.fill,t=void 0===n?"rgba(0,0,0,.38)":n;return(0,r.jsx)("svg",{className:"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium",width:"24",height:"24",viewBox:"0 0 24 24",fill:t,xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M13 10.925H11V15.125L9.39999 13.525L7.99999 14.925L12 18.95L16 14.925L14.575 13.55L13 15.125V10.925ZM17.925 22.2H6.07499C5.44165 22.2 4.90432 21.9793 4.46299 21.538C4.02099 21.096 3.79999 20.5583 3.79999 19.925V4.07499C3.79999 3.44165 4.02099 2.90399 4.46299 2.46199C4.90432 2.02065 5.44165 1.79999 6.07499 1.79999H14.075L20.2 7.92499V19.925C20.2 20.5583 19.9793 21.096 19.538 21.538C19.096 21.9793 18.5583 22.2 17.925 22.2ZM12.925 9.07499V4.07499H6.07499V19.925H17.925V9.07499H12.925ZM6.07499 4.07499V9.07499V19.925V4.07499Z"})})}},1468:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/list",function(){return t(1804)}])},6946:function(e){e.exports={"upgrade-panel":"Upgrades_upgrade-panel__e_Xz2","upgrade-panel-mobile":"Upgrades_upgrade-panel-mobile__hbg1a"}},7146:function(e){e.exports={upgradeName:"UpgradeItem_upgradeName___iRB1",upgradeRules:"UpgradeItem_upgradeRules__CFyIv"}}},function(e){e.O(0,[750,89,151,758,396,797,774,888,179],(function(){return n=1468,e(e.s=n);var n}));var n=e.O();_N_E=n}]);